# Staqueue Pattern
[日本語](index.md) | [English](index_EN.md) | [GitHub](https://github.com/stakiran/staqueue-pattern/)

## スタッキューパターンについて

### スタッキューについて
**スタッキュー(Staqueue)** とは、Stack と Queue を指します。特にこの二つのデータ構造を用いた情報管理を指します。

スタッキューでは、スタックとキューを用いてお望みの情報管理構造をつくります。たとえば普段のタスクリストとして queue1、割り込み用に stack1 と二つつくり、優先度を `stack1 > queue1` と設定すると、これは「普段は queue1 で先入れ先出し的に処理するが、割り込みが来たら stack1 で後入れ先出し的に処理しきる」運用となります。単純ですが、普段のタスクと割り込みの両方に対応するための基礎となります。

スタッキューではいくつか原則があります

- 情報管理とは個人の、個人による、個人のための情報を管理すること
    - 情報は TODO、タスク、アイデア、後で読むものなどあらゆるものが対象ですが、テキストとして表現されているものとします
    - 管理とは保存、閲覧、検索、 **処理（取り出し）**、別のスタッキューへの移動を含みます。 **編集操作は含みません**
- スタックとキューなので、以下の制約があります
    - スタックは後入れ先出しです。後に入れた情報が先に取り出されます
    - キューは先入れ先出しです。先に入れた情報が先に取り出されます
    - ランダムアクセス（任意番目の情報を操作）はしません。ただし閲覧と検索は可能です
    - 一度取り出した情報は削除されます（再投入は可能）
- 優先度があります
    - 優先度レイヤーがあり、高レイヤーのスタッキューから処理していきます

スタッキューの活用例

- 個人の情報管理（手作業）
- 個人の情報管理（ソフトウェア化する際のデータ構造）
- AIエージェント向けのデータ構造

### スタッキューパターンについて
デザインパターンのように、頻出するパターンを整理したものです。

フォーマットは次のとおり:

- 全体像
    - 左ほど高優先度であり、レイヤーは `|` で区切ります
- タスクの処理について
- タスクの追加について

全体像について例を挙げます。たとえば以下は、

```
Stack1 | Queue1
```

実際には次のような意味です。

```
High Prio <---   ---> Low Prio

(Layer1)   (Layer2)
 Stack1  |  Queue1
```

## ====

## ●テンプレ修正案
- 処理、移動、追加で分ける？
    - 処理：取り出して実行する
    - 移動：別のスタッキューに移す
    - 追加：このスタッキューパターンに入れる

## スタッキューパターン一覧

### FIFO ドリブンパターン
```
Queue-Main
Queue-Temp1
Queue-Temp1
...
```
- (タスクの処理)
    - Queue-Main を処理する
- (タスクの追加)
    - Queue-Main に追加する
    - Queue-Main へのランダムアクセスや順番入れ替えがしたい場合は、Queue-TempXX を使う

最も基本的なパターンです。スタッキューパターンでは **タスクリストなどリストは使わず** キューを使います。つまり、FIFO（先に入れたタスクが先に取り出されます）し、ランダムアクセスはしません。

しかし、FIFO だけでは不便なことがあるので、Queue-Temp も使って良いとします。Temp の本数は任意ですが、できるだけ少ない方が良いです。少なければ少ないほどスタッキューパターンに適合できていることを示します。

このとおり **FIFO ドリブンで動くことは基本中の基本** です。

### ガードスタックパターン
```
Stack1 | Queue1
```

- (タスクの処理)
    - まず Stack1 が空になるまで処理する
    - Queue1 を随時処理する。ただし Stack1 が空になるまでは触らない
- (タスクの追加)
    - 普段は Queue1 に追加する
    - 割り込みが来たら Stack1 に追加する

最も基本的なパターンの一つです。FIFO ドリブンだけだと、割り込みなど緊急性の高さに対応できませんので、スタックを導入します。

ガードスタックパターン自体は（単純化のため）Queue が一本ですが、もちろん FIFO ドリブンと組み合わせることもできます。

### レイターパターン
```
Queue-Main | Stack-Later
```

- (タスクの処理)
    - Queue-Main を随時処理する
- (タスクの追加)
    - 情報は Queue-Main に追加する
    - あとでやりたいものは Queue-Main から Stack-Later に移す
    - Stack-Later は適宜チェックして、Queue-Main に移す。Stack-Later は空にすることを心がける

レイター（Later）、つまりは「あとでやる」を実現するためのパターンです。

FIFO ドリブンは同一優先度で複数のキューを使い分けていましたが、レイターパターンでは一つ低いレイヤーにスタックを置いています。つまり「あとでやる」ものは、後に入れたものから取り出されます。溜まると底が見えなくなるので、早めに処理しようという気になりやすいです。

### カテゴリーパターン
```
Queue-Entrance | Queue1
                 Queue2
                 ...
```

- (タスクの処理)
    - QueueXX を随時処理する
- (タスクの追加)
    - まずは Queue-Entrance に追加する
    - Queue-Entrance から QueueXX に仕分ける
    - Queue-Entrance は空にすることを心がける

QueueXX のつくりかたは付録1参照。

### プロジェクトパターン
```
stack-inbox | queue-inbox | stack1  queue1
                            stack2  queue2
                            ...     ...
```

- (タスクの処理)
    - まずは stack-inbox を処理する。空になるまで処理する
    - queue-inbox から projectXX に移動させる。こまめに処理してなるべく空を保つ
    - projectXX として stackXX, queueXX, stackXX と queueXX の 3 パターンがあり、そのプロジェクトを実施する際に処理する
- (タスクの追加)
    - 割り込みなど緊急性の高いものは stack-inbox に追加する
    - それ以外は queue-inbox に追加する

プロジェクトごとにスタッキューを用意し、これらへの仕分けを「割り込み対応パターン」で受け付けます。ただし割り込みのときは仕分けは行わず、ダイレクトに処理させます。

### xxxパターン
```
```

- (タスクの処理)
    - ...
    - ...
    - ...
- (タスクの追加)
    - ...
    - ...
    - ...

### xxxパターン
```
```

- (タスクの処理)
    - ...
    - ...
    - ...
- (タスクの追加)
    - ...
    - ...
    - ...

### xxxパターン
```
```

- (タスクの処理)
    - ...
    - ...
    - ...
- (タスクの追加)
    - ...
    - ...
    - ...

## ====

## 付録

### 付録1: カテゴリーパターンにおけるカテゴリーのつくりかた
好きにすれば良いが、よく知られた軸があるため参考にすると良い。

- (文脈軸)
    - プロジェクトごと
    - 人物ごと
    - 締切目安ごと
        - たとえば「今日やる」「明日までにやる」「今週中にやる」「それ以降でいい」の 4 本
        - 日付は毎日更新されるので、毎日更新が必要。手動だと厳しい
- (主観軸)
    - 主観的な難易度ごと
        - たとえば高（頭か神経か両方を酷使する）、中（努力は必要だがまあできる）、低（時間かけたらできるもの）
    - 好き、嫌い、どっちでもない・どうでもいいの 3 本
    - やりたい、やりたくないの 2 本
    - Must、Should、Want の 3 本

また私が整理した「タスクの属性一覧」も参考になるだろう:

- [List of "Task Attributes" for Implementing Task Management - DEV Community](https://dev.to/stakiran/list-of-task-attributes-for-implementing-task-management-5e87)
